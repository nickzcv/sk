<!-- Page Content -->
<div id="page-content-wrapper">
	<div class="container-fluid">
		<a href="#menu-toggle" class="btn btn-default" id="menu-toggle">Меню</a>
		<div class="row">
			<div class="col-lg-12">
				<h1>{{meta_title}}</h1>

				{{#each pages}}

					<h3>
						<a class="edit" data-id=" " href="">{{title}}</a>
						<span class="glyphicon glyphicon-pencil edit" data-id=" " aria-hidden="true"></span>
						<span class="glyphicon glyphicon-remove-sign delete" data-id="{{_id}}" aria-hidden="true"></span>
					</h3>
					<hr>

				{{/each}}



				<h3>Создание новой страницы:</h3>

				<form method="post">
					<div class="form-group">
						<div class="checkbox">
							<label><input type="checkbox" name="isMain">Это основная страница?</label>
						</div>
						<div class="form-group">
							<label for="title">Название Страницы:</label>
							<input type="text" class="form-control" name="title" id="title">
						</div>
						<div class="form-group">
							<label for="cat">Категория:</label>
							<select class="form-control" id="cat" name="category">
							</select>
						</div>
						<div class="form-group">
							<label for="description">Краткое содержание <i>(для поисковиков)</i>:</label>
							<input type="text" class="form-control" name="description" id="description">
						</div>
						<div class="form-group">
							<label for="content">Содержание страницы:</label>
							<textarea class="form-control" rows="5" name="content" id="content"></textarea>
						</div>
					</div>


					<button type="submit" class="btn btn-primary">Создать страницу</button>
				</form>









			</div>
		</div>
	</div>
</div>
<!-- /#page-content-wrapper -->

<script>

	$(function(){

		$.ajax({
			type: 'GET',
			url: '/api/categories-list',
			dataType: 'json'
		}).success( function(data) {
			initSelect(data);
		});


		function initSelect(data) {
			var select = $('#cat');

			for (var i = 0; i < data.length; i++){
				var option=$('<option></option>');
				option.attr('value',data[i]._id);
				option.text(data[i].title);
				select.append(option);
			}
		}

		// DELETE
		$('.delete').on('click', function(e) {
			e.preventDefault();

			var result = confirm('Точно удалить?');

			if (result) {
				$.ajax({
					type: 'DELETE',
					url: 'pages/'+$(this).data('id')
				}).success( function() {
					location.reload();
				});
			}

		});



	});

</script>